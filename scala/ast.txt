Block(
List(
ValDef(Modifiers(), TermName("res"),
                    AppliedTypeTree(Select(Ident(com.paytronix.utils.scala.result), TypeName("ResultGT")), List(Select(Ident(TermName("ResultGTTest")), TypeName("TimeWriter")), Ident(scala.Unit), Ident(scala.Unit))),
                    Apply(Apply(Select(Apply(Select(Ident(TermName("ResultGTTest")), TermName("timeAs")), List(Literal(Constant("r1 time")), Select(Ident(TermName("ResultGTTest")), TermName("r1")))), TermName("flatMap")), List(Function(List(ValDef(Modifiers(PARAM), TermName("b"), TypeTree(), EmptyTree)), Apply(Apply(Select(Apply(Apply(Select(Apply(Select(Ident(TermName("ResultGTTest")), TermName("timeAs")), List(Literal(Constant("x time")), Select(Ident(TermName("ResultGTTest")), TermName("r1")))), TermName("flatMap")), List(Function(List(ValDef(Modifiers(PARAM), TermName("x"), TypeTree(), EmptyTree)), Apply(Apply(Select(Apply(Select(Ident(TermName("ResultGTTest")), TermName("timeAs")), List(Literal(Constant("y time")), Select(Ident(TermName("ResultGTTest")), TermName("r2")))), TermName("flatMap")), List(Function(List(ValDef(Modifiers(PARAM), TermName("y"), TypeTree(), EmptyTree)), Apply(Apply(Select(Apply(Select(Ident(TermName("ResultGTTest")), TermName("endTimeFor")), List(Literal(Constant("subtree")))), TermName("map")), List(Function(List(ValDef(Modifiers(PARAM), termNames.WILDCARD, TypeTree(), EmptyTree)), Literal(Constant(()))))), List(Select(Ident(TermName("ResultGTTest")), TermName("TWMonad"))))))), List(Select(Ident(TermName("ResultGTTest")), TermName("TWMonad"))))))), List(Select(Ident(TermName("ResultGTTest")), TermName("TWMonad")))), TermName("flatMap")), List(Function(List(ValDef(Modifiers(PARAM), TermName("a"), TypeTree(), EmptyTree)), Apply(Apply(Select(Block(List(ValDef(Modifiers(SYNTHETIC | ARTIFACT), TermName("x$25"), TypeTree(), Literal(Constant("r2 time")))), Apply(Select(Apply(Select(Ident(TermName("ResultGTTest")), TermName("TimeLift")), List(Select(Ident(TermName("ResultGTTest")), TermName("r2")))), TermName("time$colon")), List(Ident(TermName("x$25"))))), TermName("flatMap")), List(Function(List(ValDef(Modifiers(PARAM), TermName("c"), TypeTree(), EmptyTree)), Apply(Apply(Select(Apply(Select(Ident(TermName("ResultGTTest")), TermName("endTimeFor")), List(Literal(Constant("testTime")))), TermName("map")), List(Function(List(ValDef(Modifiers(PARAM), termNames.WILDCARD, TypeTree(), EmptyTree)), Literal(Constant(()))))), List(Select(Ident(TermName("ResultGTTest")), TermName("TWMonad"))))))), List(Select(Ident(TermName("ResultGTTest")), TermName("TWMonad"))))))), List(Select(Ident(TermName("ResultGTTest")), TermName("TWMonad"))))))), List(Select(Ident(TermName("ResultGTTest")), TermName("TWMonad")))))), Apply(Select(Select(Ident(TermName("res")), TermName("run")), TermName("written")), List(Select(Ident(scalaz.package), TermName("idInstance")))))



check service macro:

def simulateAccrualAndRedemption(......) = {
    val simF = if (config.time) time(simulateAccrualAndRedemption _) simulateAccrualAndRedemption _
    simF(........)
